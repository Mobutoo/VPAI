{
  "gateway": {
    "mode": "local",
    "port": {{ openclaw_gateway_port }},
    "bind": "{{ openclaw_gateway_bind }}",
    "auth": {
      "mode": "token",
      "token": "${OPENCLAW_GATEWAY_TOKEN}"
    },
    "trustedProxies": ["{{ docker_network_backend_subnet }}"],
    "controlUi": {
      "enabled": true,
      "basePath": "/",
      "allowInsecureAuth": true,
      "allowedOrigins": ["https://{{ admin_subdomain }}.{{ domain_name }}"]
    }
  },
  "agents": {
    "defaults": {
      "workspace": "/home/node/.openclaw/workspace",
      "userTimezone": "{{ timezone }}",
      "model": {
        "primary": "{{ openclaw_default_model }}"
      },
      "sandbox": {
        "mode": "{{ openclaw_sandbox_mode | default('non-main') }}",
        "scope": "agent",
        "workspaceAccess": "none",
        "docker": {
          "image": "{{ openclaw_sandbox_image | default('openclaw-sandbox:bookworm-slim') }}",
          "readOnlyRoot": true,
          "tmpfs": ["/tmp", "/var/tmp", "/run"],
          "network": "{{ project_name }}_sandbox",
          "user": "1000:1000",
          "capDrop": ["ALL"],
          "pidsLimit": 256,
          "memory": "{{ openclaw_sandbox_memory | default('1g') }}",
          "cpus": {{ openclaw_sandbox_cpus | default(1) }}
        },
        "prune": {
          "idleHours": 24,
          "maxAgeDays": 7
        }
      },
      "subagents": {
        "maxConcurrent": 4,
        "archiveAfterMinutes": 120
      }
    },
    "list": [
      {
        "id": "{{ openclaw_agent_concierge_name }}",
        "default": true,
        "model": {
          "primary": "{{ openclaw_concierge_model }}"
        },
        "workspace": "/home/node/.openclaw/workspace",
        "subagents": {
          "allowAgents": [
            "{{ openclaw_agent_builder_name }}",
            "{{ openclaw_agent_writer_name }}",
            "{{ openclaw_agent_artist_name }}",
            "{{ openclaw_agent_tutor_name }}",
            "{{ openclaw_agent_explorer_name }}"
          ]
        },
        "tools": {
          "fs": { "workspaceOnly": true },
          "elevated": { "enabled": false }
        }
      },
      {
        "id": "{{ openclaw_agent_builder_name }}",
        "model": {
          "primary": "{{ openclaw_builder_model }}"
        },
        "workspace": "/home/node/.openclaw/workspace",
        "tools": {
          "fs": { "workspaceOnly": true },
          "exec": {
            "applyPatch": { "workspaceOnly": true },
            "timeoutSec": 300
          },
          "elevated": { "enabled": false }
        }
      },
      {
        "id": "{{ openclaw_agent_writer_name }}",
        "model": {
          "primary": "{{ openclaw_writer_model }}"
        },
        "workspace": "/home/node/.openclaw/workspace",
        "tools": {
          "fs": { "workspaceOnly": true },
          "elevated": { "enabled": false }
        }
      },
      {
        "id": "{{ openclaw_agent_artist_name }}",
        "model": {
          "primary": "{{ openclaw_artist_model }}"
        },
        "workspace": "/home/node/.openclaw/workspace",
        "tools": {
          "fs": { "workspaceOnly": true },
          "elevated": { "enabled": false }
        }
      },
      {
        "id": "{{ openclaw_agent_tutor_name }}",
        "model": {
          "primary": "{{ openclaw_tutor_model }}"
        },
        "workspace": "/home/node/.openclaw/workspace/tutor",
        "tools": {
          "fs": { "workspaceOnly": true },
          "elevated": { "enabled": false }
        }
      },
      {
        "id": "{{ openclaw_agent_explorer_name }}",
        "model": {
          "primary": "{{ openclaw_explorer_model }}"
        },
        "workspace": "/home/node/.openclaw/workspace",
        "sandbox": {
          "mode": "all",
          "docker": {
            "network": "{{ project_name }}_egress"
          }
        },
        "tools": {
          "fs": { "workspaceOnly": true },
          "elevated": { "enabled": false }
        }
      }
    ]
  },
  "models": {
    "mode": "merge",
    "providers": {
      "custom-litellm": {
        "baseUrl": "http://litellm:4000/v1",
        "apiKey": "${LITELLM_API_KEY}",
        "api": "openai-completions",
        "models": [
          {
            "id": "claude-opus",
            "name": "Claude Opus 4 (premium)",
            "reasoning": true,
            "input": ["text"],
            "contextWindow": 200000,
            "maxTokens": 16384
          },
          {
            "id": "claude-sonnet",
            "name": "Claude Sonnet 4 (writing/analysis)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 200000,
            "maxTokens": 8192
          },
          {
            "id": "claude-haiku",
            "name": "Claude Haiku 4.5 (quick/summary)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 200000,
            "maxTokens": 8192
          },
          {
            "id": "gpt-4o",
            "name": "GPT-4o (multimodal fallback)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 128000,
            "maxTokens": 16384
          },
          {
            "id": "gpt-4o-mini",
            "name": "GPT-4o Mini (classification)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 128000,
            "maxTokens": 16384
          },
          {
            "id": "gpt-codex",
            "name": "GPT Codex (code review)",
            "reasoning": true,
            "input": ["text"],
            "contextWindow": 200000,
            "maxTokens": 16384
          },
{% if openrouter_api_key | default('') | length > 0 %}
          {
            "id": "kimi-k2",
            "name": "Kimi K2.5 (concierge/agent)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 131072,
            "maxTokens": 8192
          },
          {
            "id": "minimax-m25",
            "name": "MiniMax M2.5 (bulk/review)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 1048576,
            "maxTokens": 16384
          },
          {
            "id": "deepseek-r1",
            "name": "DeepSeek R1 (reasoning)",
            "reasoning": true,
            "input": ["text"],
            "contextWindow": 131072,
            "maxTokens": 8192
          },
          {
            "id": "deepseek-v3",
            "name": "DeepSeek V3.2 (code gen)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 131072,
            "maxTokens": 8192
          },
{% endif %}
          {
            "id": "embedding",
            "name": "Embeddings (cache/RAG)",
            "reasoning": false,
            "input": ["text"],
            "contextWindow": 8191,
            "maxTokens": 1
          }
        ]
      }
    }
  },
  "tools": {
    "elevated": {
      "enabled": false
    },
    "exec": {
      "applyPatch": {
        "workspaceOnly": true
      },
      "timeoutSec": 120
    },
    "fs": {
      "workspaceOnly": true
    }
  },
  "channels": {
{% if telegram_openclaw_bot_token | default('') | length > 0 %}
    "telegram": {
      "botToken": "${TELEGRAM_BOT_TOKEN}",
{% if telegram_openclaw_chat_id | default('') | length > 0 %}
      "dmPolicy": "allowlist",
      "allowFrom": ["{{ telegram_openclaw_chat_id }}"]
{% else %}
      "dmPolicy": "pairing"
{% endif %}
    }{{ ',' if whatsapp_tutor_enabled | default(false) else '' }}
{% endif %}
{% if whatsapp_tutor_enabled | default(false) %}
    "whatsapp": {
      "provider": "baileys",
      "dmPolicy": "pairing"
    }
{% endif %}
  },
  "bindings": [
{% if telegram_openclaw_bot_token | default('') | length > 0 %}
    {
      "agentId": "{{ openclaw_agent_concierge_name }}",
      "match": { "channel": "telegram" }
    }{{ ',' if whatsapp_tutor_enabled | default(false) else '' }}
{% endif %}
{% if whatsapp_tutor_enabled | default(false) %}
    {
      "agentId": "{{ openclaw_agent_tutor_name }}",
      "match": { "channel": "whatsapp" }
    }
{% endif %}
  ],
  "logging": {
    "level": "info"
  }
}
