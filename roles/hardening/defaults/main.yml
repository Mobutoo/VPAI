---
# hardening â€” defaults

# --- SSH ---
hardening_ssh_port: "{{ prod_ssh_port_target | default(prod_ssh_port) }}"
hardening_ssh_listen_address: "{{ vpn_headscale_ip }}"
hardening_ssh_allowed_user: "{{ prod_user }}"
hardening_ssh_max_auth_tries: 3
hardening_ssh_login_grace_time: 30
hardening_ssh_client_alive_interval: 300
hardening_ssh_client_alive_count_max: 2
hardening_ssh_authorized_keys: "{{ ssh_authorized_keys }}"

# --- Anti-lockout ---
# Force SSH to listen on all interfaces and allow SSH from anywhere.
# Use this for first deploy or debug sessions when VPN is not yet ready.
# Set to true to bypass VPN-only SSH restriction.
hardening_ssh_force_open: false

# --- Fail2Ban ---
hardening_fail2ban_bantime: 3600
hardening_fail2ban_findtime: 600
hardening_fail2ban_maxretry: 3
hardening_fail2ban_caddy_maxretry: 10
hardening_fail2ban_caddy_botsearch_maxretry: 5
hardening_fail2ban_caddy_botsearch_bantime: 86400

# --- UFW ---
hardening_ufw_allowed_tcp_ports:
  - "80"
  - "443"

hardening_ufw_vpn_network: "{{ vpn_network_cidr }}"
hardening_ufw_tailscale_port: "41641"

# --- CrowdSec ---
hardening_crowdsec_collections:
  - crowdsecurity/linux
  - crowdsecurity/sshd
  - crowdsecurity/nginx
  - crowdsecurity/http-cve

# --- Unattended upgrades ---
hardening_unattended_upgrades_origins:
  - "origin=Debian,codename=${distro_codename},label=Debian-Security"

hardening_unattended_auto_reboot: "false"
