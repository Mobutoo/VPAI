---
# openclaw — defaults

openclaw_config_dir: "/opt/{{ project_name }}/configs/openclaw"
openclaw_data_dir: "/opt/{{ project_name }}/data/openclaw"

# Gateway port (WebSocket control plane + Control UI)
openclaw_gateway_port: 18789

# Gateway bind mode: loopback | lan | tailnet
# "lan" required for Docker (container must accept connections from Caddy network)
openclaw_gateway_bind: "lan"

# Default agent model (routed through LiteLLM proxy)
openclaw_default_model: "custom-litellm/claude-sonnet"

# Node.js heap size in MB (prevents OOM crashes on large context windows)
openclaw_node_heap_mb: 768

# --- Sandbox (agent tool execution isolation) ---
# Sandbox requires Docker socket mount — Gateway spawns isolated containers
# Modes: "off" (no sandbox), "non-main" (sandbox subagents only), "all" (full isolation)
openclaw_sandbox_mode: "non-main"
openclaw_sandbox_image: "openclaw-sandbox:bookworm-slim"
openclaw_sandbox_memory: "1g"
openclaw_sandbox_cpus: 1

# --- Volume Isolation (moltworker pattern) ---
# When enabled, splits the flat openclaw data dir into 3 layers:
#   system/ (ro) — openclaw.json, agents/, skills/, plugins/
#   workspace/ (rw) — user livrables (books, prospection, output)
#   state/ (rw) — sessions, canvas, cron, memory
# This prevents prompt injection or compromised agents from modifying system configs.
openclaw_volume_isolation: true
openclaw_system_dir: "/opt/{{ project_name }}/data/openclaw/system"
openclaw_workspace_dir: "/opt/{{ project_name }}/data/openclaw/workspace"
openclaw_state_dir: "/opt/{{ project_name }}/data/openclaw/state"

# Workspace subdirectories (user data — livrables, content, projects)
openclaw_workspace_subdirs:
  - books
  - prospection
  - output
  - finance
  - ops

# State subdirectories (runtime data — sessions, canvas, cron, memory)
openclaw_state_subdirs:
  - sessions
  - canvas
  - cron
  - memory

# --- Multi-Agent Configuration ---
# Agent names (placeholders — updated later when user chooses names)
openclaw_agent_concierge_name: "concierge"
openclaw_agent_builder_name: "builder"
openclaw_agent_writer_name: "writer"
openclaw_agent_artist_name: "artist"
openclaw_agent_tutor_name: "tutor"
openclaw_agent_explorer_name: "explorer"
openclaw_agent_marketer_name: "marketer"
openclaw_agent_cfo_name: "cfo"
openclaw_agent_maintainer_name: "maintainer"

# Structured agents list for auto-sync to Kaneo (n8n agents-kaneo-sync workflow)
# Adding an agent here = it appears automatically in Kaneo UI after next deploy
openclaw_agents_list:
  - id: "{{ openclaw_agent_concierge_name }}"
    name: "Mobutoo"
    type: "orchestrator"
    model: "{{ openclaw_concierge_model }}"
  - id: "{{ openclaw_agent_builder_name }}"
    name: "Imhotep"
    type: "builder"
    model: "{{ openclaw_builder_model }}"
  - id: "{{ openclaw_agent_writer_name }}"
    name: "Thot"
    type: "writer"
    model: "{{ openclaw_writer_model }}"
  - id: "{{ openclaw_agent_artist_name }}"
    name: "Basquiat"
    type: "artist"
    model: "{{ openclaw_artist_model }}"
  - id: "{{ openclaw_agent_tutor_name }}"
    name: "Piccolo"
    type: "tutor"
    model: "{{ openclaw_tutor_model }}"
  - id: "{{ openclaw_agent_explorer_name }}"
    name: "R2D2"
    type: "explorer"
    model: "{{ openclaw_explorer_model }}"
  - id: "{{ openclaw_agent_marketer_name }}"
    name: "Marketer"
    type: "marketer"
    model: "{{ openclaw_marketer_model }}"
  - id: "{{ openclaw_agent_cfo_name }}"
    name: "CFO"
    type: "finance"
    model: "{{ openclaw_cfo_model }}"
  - id: "{{ openclaw_agent_maintainer_name }}"
    name: "Maintainer"
    type: "devops"
    model: "{{ openclaw_maintainer_model }}"

# Model assignments per agent/task (routed through LiteLLM)
# Strategy: open-source first, Anthropic/OpenAI only when precision demands it
# Review: builder uses qwen3-coder, review by different family (GLM-5 or gpt-codex)
# NOTE: kimi-k2 ecarté du concierge/tutor — tokens tool_call_begin/end fuient en texte brut
# via OpenRouter (bug upstream kimi-k2 tool calling). minimax-m25 = Function Calling #1 (76.8%)
openclaw_concierge_model: "custom-litellm/minimax-m25"
openclaw_builder_model: "custom-litellm/qwen3-coder"
openclaw_writer_model: "custom-litellm/glm-5"
openclaw_artist_model: "custom-litellm/minimax-m25"
openclaw_tutor_model: "custom-litellm/minimax-m25"
openclaw_explorer_model: "custom-litellm/grok-search"
openclaw_marketer_model: "custom-litellm/minimax-m25"
openclaw_cfo_model: "custom-litellm/minimax-m25"
openclaw_maintainer_model: "custom-litellm/qwen3-coder"
openclaw_code_model: "custom-litellm/qwen3-coder"
openclaw_quick_model: "custom-litellm/deepseek-v3"
openclaw_cheap_model: "custom-litellm/qwen3-coder"

# --- Skills ---
# Centralized list of all OpenClaw skills (used in 3 task loops: dirs, deploy, cleanup)
openclaw_skills:
  - delegate-n8n
  - search-content
  - generate-visual
  - rate-response
  - budget-monitor
  - cost-analysis
  - infra-maintain
  - deploy-check
  - task-management
  - image-generation
  - video-composition
  - code-fix-github
  - finance-personal

# --- n8n Integration ---
openclaw_n8n_integration: true
openclaw_n8n_workflows:
  - name: translate
    path: ai-translate
    description: "Traduire du contenu via LiteLLM (haiku)"
  - name: summarize
    path: ai-summarize
    description: "Resumer du contenu long via LiteLLM"
  - name: format-data
    path: ai-format
    description: "Formater des donnees structurees"
  - name: model-feedback
    path: ai-model-feedback
    description: "Envoyer un feedback like/dislike sur un modele"
  - name: model-scores
    path: ai-model-scores
    description: "Consulter le tableau de ponderation des modeles"

# --- Budget Control (commands Telegram → n8n webhook) ---
# Commandes reconnues par le concierge OpenClaw (via Telegram) :
#   /budget          → statut détaillé (spend 24h par provider)
#   /budget eco on   → activer mode éco (modèles gratuits forcés)
#   /budget eco off  → retour mode normal
# Ces commandes appellent le webhook n8n "budget-control"
openclaw_budget_webhook_url: "http://n8n:5678/webhook/budget-control"
openclaw_budget_commands:
  - trigger: "/budget eco on"
    action: "eco_on"
    description: "Activer mode économie (modèles gratuits)"
  - trigger: "/budget eco off"
    action: "eco_off"
    description: "Désactiver mode économie (retour normal)"
  - trigger: "/budget"
    action: "status"
    description: "Afficher le budget IA actuel"

# --- Telegram Bot (dedicated, distinct from monitoring bot) ---
# telegram_openclaw_bot_token is in main.yml (from vault)
# telegram_openclaw_chat_id is in main.yml (from vault)

# --- WhatsApp (Tutor channel — child tablet) ---
# whatsapp_tutor_enabled and phone set in main.yml
