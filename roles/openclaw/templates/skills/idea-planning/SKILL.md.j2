---
name: idea-planning
description: Universal idea lifecycle â€” qualification, co-construction multi-agents, versioning Kaneo, approbation Telegram.
metadata: { "openclaw": { "emoji": "ğŸ’¡" } }
---

# Skill : Idea Planning â€” BoÃ®te Ã  IdÃ©es

Cycle de vie universel d'une idÃ©e : de l'intention au projet dispachÃ©.
Fonctionne pour TOUT type de projet : tech, business, perso, physique, finance.

## Phase 1 â€” Qualification par dialogue (OBLIGATOIRE avant toute gÃ©nÃ©ration)

Patterns dÃ©clencheurs (dÃ©tecter dans le message) :
- "j'ai une idÃ©e", "on devrait faire", "imagine qu'on crÃ©e", "est-ce faisable de"
- "que penses-tu de crÃ©er", "j'envisage de", "si on lanÃ§ait", "et si on faisait"

â†’ **Ne pas gÃ©nÃ©rer automatiquement.** Engager d'abord un dialogue de qualification.

### Ã‰tape 1 â€” Reformulation + confirmation
> "Je dÃ©tecte une idÃ©e de projet : <reformulation en 1 phrase>. C'est bien Ã§a ?"

Sur confirmation â†’ Ã‰tape 2. Sur refus â†’ traiter comme question normale.

### Ã‰tape 2 â€” Questions de qualification (2-3 questions max, adaptÃ©es au domaine)

Poser les questions les plus utiles selon le domaine dÃ©tectÃ©. Exemples :

**Si tech/infra :**
- "C'est pour amÃ©liorer la stack existante ou crÃ©er quelque chose de nouveau ?"
- "Tu as une contrainte de budget ou de dÃ©lai particuliÃ¨re ?"
- "Des dÃ©pendances avec ce qu'on a dÃ©jÃ  (n8n, Kaneo, OpenClaw...) ?"

**Si business/produit :**
- "C'est B2B, B2C, ou usage interne ?"
- "Tu as dÃ©jÃ  une idÃ©e de la cible (audience/clients) ?"
- "Quel serait le signe que c'est un succÃ¨s dans 3 mois ?"

**Si finance/investissement :**
- "Tu as une enveloppe en tÃªte ? Et un horizon de temps ?"
- "Risque tolÃ©rÃ© : conservateur, Ã©quilibrÃ©, ou dynamique ?"

**Si physique/perso :**
- "C'est pour quand ? Et tu as dÃ©jÃ  commencÃ© Ã  regarder ?"
- "Il y a des contraintes (budget, lieu, temps) Ã  intÃ©grer ?"

### Ã‰tape 3 â€” RÃ©capitulatif avant lancement
Reformuler en 2-3 phrases ce que tu as compris, puis demander :
> "J'ai bien cernÃ© l'idÃ©e. Je lance l'analyse complÃ¨te (Explorer + CFO + Builder en parallÃ¨le) â€” Ã§a prend ~30 secondes. Go ?"

Sur confirmation â†’ lancer la co-construction.
Sur ajustement â†’ intÃ©grer et relancer l'Ã©tape 3.

---

## Co-construction multi-agents (parallÃ¨le, max 4)

Lancer simultanÃ©ment :

```
sessions_spawn(explorer, "Contexte pour idÃ©e : <titre>. Recherche : alternatives existantes, Ã©tat du marchÃ©, concurrents directs, retours d'expÃ©rience similaires. Retourne JSON {context: string, alternatives: [string], market_state: string, key_risks: [string]}")

sessions_spawn(cfo, "Estimation financiÃ¨re pour idÃ©e : <titre> dans notre contexte. Estime : budget initial, coÃ»ts rÃ©currents mensuels, ROI estimÃ©, dÃ©lai de retour sur investissement. Retourne JSON {budget_initial: string, monthly_costs: string, roi_timeline: string, risks_financial: [string]}")

sessions_spawn(builder, "Ã‰valuation faisabilitÃ© pour idÃ©e : <titre>. Estime : stack technique nÃ©cessaire, effort en semaines, dÃ©pendances critiques, risques techniques. Si non-tech : Ã©valuer ressources humaines/matÃ©rielles. Retourne JSON {tech_stack: [string], estimated_effort: string, dependencies: [string], technical_risks: [string]}")
```

Pendant ce temps, le Concierge prÃ©pare :
- SWOT (forces/faiblesses/opportunitÃ©s/menaces)
- RACI (responsible/accountable/consulted/informed)
- implementation_steps (liste ordonnÃ©e d'Ã©tapes concrÃ¨tes)
- challenger (alternative ou approche concurrente)
- kpi_victoire (mÃ©triques de succÃ¨s mesurables)

Merger les 4 contributions â†’ plan JSON unifiÃ©.

---

## Structure JSON du plan (agnostique au domaine)

```json
{
  "title": "Nom court du projet (5 mots max)",
  "domain": "tech|business|perso|physique|finance|autre",
  "summary": "Description 2-3 phrases â€” contexte + objectif + valeur ajoutÃ©e",
  "swot": {
    "strengths": ["Point fort 1", "Point fort 2"],
    "weaknesses": ["Faiblesse 1"],
    "opportunities": ["OpportunitÃ© 1"],
    "threats": ["Menace 1"]
  },
  "raci": {
    "responsible": ["builder (si tech) | cfo (si finance) | user (si perso/physique)"],
    "accountable": "concierge|user",
    "consulted": ["explorer", "cfo"],
    "informed": ["maintainer (si impact infra)"]
  },
  "risks": [
    {
      "risk": "Description du risque",
      "probability": "high|medium|low",
      "impact": "critical|major|minor",
      "mitigation": "Action corrective"
    }
  ],
  "resources": {
    "tech_stack": ["Service1", "Outil2"],
    "tools": ["Outil physique ou service tiers (pour projets non-tech)"],
    "budget_estimated": "Xâ‚¬ initial + Yâ‚¬/mois",
    "timeline": "X semaines | X mois"
  },
  "challenger": "Alternative ou approche concurrente existante â€” pourquoi ce plan est meilleur",
  "kpi_victoire": [
    "KPI mesurable 1 â€” ex: 100 clients en 3 mois",
    "KPI mesurable 2 â€” ex: ROI positif Ã  6 mois"
  ],
  "implementation_steps": [
    "Ã‰tape 1 : action concrÃ¨te assignable",
    "Ã‰tape 2 : action concrÃ¨te assignable",
    "Ã‰tape 3 : action concrÃ¨te assignable"
  ]
}
```

### RÃ¨gles domain-specific

| Domain | tech_stack | tools | Responsible RACI |
|--------|------------|-------|-----------------|
| `tech` | Services Docker, langages, frameworks | vide | `builder` |
| `business` | Outils SaaS, CRM, site web | Outils physiques/commerciaux | `user` + `cfo` |
| `finance` | Broker, plateforme d'investissement | vide | `cfo` |
| `physique` | Minimal ou vide | MatÃ©riaux, Ã©quipements, fournisseurs | `user` |
| `perso` | Minimal ou vide | Applications, services | `user` |
| `autre` | Selon contexte | Selon contexte | `user` |

---

## Format de prÃ©sentation Telegram

```
ğŸ’¡ <titre> [<domain>]
ğŸ“‹ <summary>

âš¡ Effort : <estimated_effort> | ğŸ’° Budget : <budget_estimated>
ğŸ¯ KPIs : <kpi_victoire[0]>

âœ… Atouts : <strengths[0]>, <strengths[1]>
âš ï¸  Risque principal : <risks[0].risk> (prob. : <risks[0].probability>)

ğŸ‘¥ Ã‰quipe proposÃ©e :
  â€¢ <emoji_agent1> <nom_agent1> â€” <phase ou rÃ´le>
  â€¢ <emoji_agent2> <nom_agent2> â€” <phase ou rÃ´le>
  (liste basÃ©e sur raci.responsible + raci.consulted)

ğŸ”— Plan complet : <lien Kaneo task>
```

**Correspondance agents â†’ emoji :**
- builder (Imhotep) â†’ âš™ï¸
- writer (Thot) â†’ âœï¸
- artist (Basquiat) â†’ ğŸ¨
- explorer (R2D2) â†’ ğŸ”
- cfo (CFO) â†’ ğŸ’°
- maintainer (Maintainer) â†’ ğŸ”§
- user â†’ ğŸ‘¤

### Streaming progressif (V3 â€” OpenClaw v2026.2.22)

**Ã‰tape 0 â€” Message placeholder** (avant de lancer les agents) :
```
sessions_spawn(messenger, "telegram_send_placeholder msg=â³ Analyse en cours...")
```
â†’ Stocker le message_id retournÃ©.

**Ã‰tape 1 â€” Spawn parallÃ¨le** (inchangÃ© â€” Explorer, CFO, Builder simultanÃ©ment)

**Ã‰tape 2 â€” Mise Ã  jour progressive au retour de chaque agent** :
```
# Retour Explorer :
sessions_spawn(messenger, "telegram_edit message_id=<mid> text=â³ Analyse en cours...\nâœ… Contexte marchÃ© analysÃ©")
# Retour CFO :
sessions_spawn(messenger, "telegram_edit message_id=<mid> text=â³ Analyse en cours...\nâœ… Contexte marchÃ© analysÃ©\nâœ… Budget : <montant>")
# Retour Builder :
sessions_spawn(messenger, "telegram_edit message_id=<mid> text=â³ Analyse en cours...\nâœ… Contexte marchÃ© analysÃ©\nâœ… Budget estimÃ©\nâœ… FaisabilitÃ© Ã©valuÃ©e")
```

**Ã‰tape 3 â€” Message final avec plan + boutons** :
```
sessions_spawn(messenger, "create_idea_plan title=<titre> domain=<domain> plan_json_b64=<base64_du_plan_JSON>")
```
â†’ RÃ©cupÃ©rer task_id retournÃ© par Messenger
â†’ Ã‰diter le message placeholder avec le rÃ©sumÃ© final + boutons inline :
```
sessions_spawn(messenger, "telegram_edit message_id=<mid> text=<plan_resume> reply_markup_b64=<base64_keyboard>")
```
Boutons inline :
  [âœ… Approuver] callback_data=approve:<task_id>
  [âœï¸ Modifier]  callback_data=modify:<task_id>
  [âŒ Refuser]   callback_data=reject:<task_id>

**Aussi â€” indexer en mÃ©moire** :
```
sessions_spawn(messenger, "update_ideas_memory task_id=<id> title=<titre> domain=<domain> status=In Review summary=<summary>")
```

---

## Gestion des itÃ©rations

### DÃ©tection du contexte (message libre aprÃ¨s plan prÃ©sentÃ©)

Quand `active_idea_id` est dÃ©fini en Redis (`idea:{chat_id}:active_idea_id`) :
- **Ne pas re-dÃ©clencher la phase qualification**
- InterprÃ©ter le message comme feedback sur le plan existant
- Si ambigu â†’ demander : "Tu veux modifier le plan en cours ou parler d'autre chose ?"

RÃ¨gle : **un message aprÃ¨s un plan prÃ©sentÃ© = feedback par dÃ©faut**, sauf si le message est clairement hors-sujet.

### Sur message "modifier" / feedback libre (plan existant)
1. Confirmer la comprÃ©hension du feedback :
   > "OK, je retiens : <reformulation feedback en 1 phrase>. Je relance l'analyse avec cet ajustement."
2. Relancer co-construction avec feedback intÃ©grÃ© :
   â†’ Prompt Explorer : "...Feedback utilisateur : <feedback>. PrÃ©cÃ©dent contexte : <context_v1>. Affine tes recherches."
   â†’ Prompt CFO : "...Feedback : <feedback>. RÃ©vise si nÃ©cessaire le budget/dÃ©lai."
   â†’ Prompt Builder : "...Feedback : <feedback>. RÃ©vise si nÃ©cessaire la faisabilitÃ©."
3. Merger â†’ plan vN
4. `sessions_spawn(messenger, "update_idea task_id=<id> version=<N> feedback=<texte_url_encoded> plan_json_b64=<base64>")`
5. Renvoyer rÃ©sumÃ© + boutons

### Sur callback "modify:<task_id>" (bouton Telegram)
1. Demander Ã  l'utilisateur : "Qu'est-ce que tu veux modifier ? (garde le reste)"
2. Attendre la rÃ©ponse â†’ traiter comme "Sur message modifier" ci-dessus

### Sur callback "approve:<task_id>"
1. `sessions_spawn(messenger, "approve_idea task_id=<id>")`
2. Confirmer Ã  l'utilisateur : "âœ… Plan approuvÃ© ! DispatchÃ© vers Kaneo avec les tÃ¢ches assignÃ©es."

### Sur callback "reject:<task_id>"
1. `sessions_spawn(messenger, "reject_idea task_id=<id> reason=Refus utilisateur")`
2. Confirmer : "âŒ IdÃ©e archivÃ©e dans Kaneo."

---

## RÃ¨gles de versioning dans Kaneo

- Max 3 versions actives dans la description Kaneo
- Au-delÃ  : le Messenger archive les plus anciennes dans un `add_comment`
- Format des dÃ©limiteurs (regex-safe) :

```
---IDEA-PLAN-META-START---
{"id":"idea-<YYYY-MM-DD>-<NNN>","domain":"<domain>","status":"pending","iterations":<N>,"created":"<YYYY-MM-DD>"}
---IDEA-PLAN-META-END---

---IDEA-PLAN-V1-START---
{...plan JSON complet...}
---IDEA-PLAN-V1-END---

---IDEA-FEEDBACK-V1-START---
{"from":"user","date":"<ISO8601>","comment":"<feedback>","type":"modify"}
---IDEA-FEEDBACK-V1-END---

---IDEA-PLAN-V2-START---
{...plan rÃ©visÃ©...}
---IDEA-PLAN-V2-END---
```

---

## RÃ¨gle absolue

**JAMAIS** crÃ©er de projet rÃ©el, de tÃ¢ches Kaneo ou assigner des ressources AVANT l'approbation explicite via bouton [âœ… Approuver].

La co-construction = gÃ©nÃ©ration d'un plan. Pas d'exÃ©cution.
